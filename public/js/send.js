$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".send-ask").on("click",function(){var t=$(this);unical=$(this).data("popup-id");var a,e,i,n=(e=$("#"+unical+" .popup_field"),a=!1,e.each(function(){$this=$(this),""==$this.val()&&"bool"!=$this.data("field-type")&&(a=!0,$this.addClass("error"),$this.on("change",function(){$(this).removeClass("error")})),"email"!=$this.data("field-name")&&"mail"!=$this.data("field-name")||(/\S+@\S+/gim.test($this.val())||(a=!0,$this.addClass("error"),$this.on("change",function(){$(this).removeClass("error")})))}),a),s={};s.form=$(this).data("type-name"),e="#"+unical+" .popup_field",i=s,$(e).each(function(){var a=$(this);"bool"==a.data("field-type")?a.is(":checked")?i[a.data("field-name")]=!0:i[a.data("field-name")]="":i[a.data("field-name")]=a.val()}),n?("quest"==unical?$("#"+unical+" .public"):$("#"+unical+" .text")).text("Не все поля заполнены верно"):(s=$.ajax({type:"POST",url:"/feedback/mail",data:s,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),t.addClass("load"),s.done(function(a){var e;$.magnificPopup.open({items:{src:"#thanks"},type:"inline"}),e=unical,$("#"+e+" .popup_field").each(function(){$(this).val("")}),t.removeClass("load")}),s.fail(function(a){t.removeClass("load")}))})});